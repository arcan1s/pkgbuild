# Maintainer: Jared Sutton <jpsutton@gmail.com>
# Maintainer: Evgeniy Alekseev <esalexeev@gmail.com>

pkgname=qscite
pkgver=0.5_svn211
_pkgrev=211
pkgrel=2
pkgdesc="A code editor written in C++ and Qt4; A clone of SciTE."
arch=('i686' 'x86_64')
url="http://qscite.googlecode.com/"
license=('GPL')
depends=('qt4')
source=(http://qscite.googlecode.com/files/${pkgname}-r${_pkgrev}.tar.gz)
md5sums=('2ce7a915e5560725d897816688a4bef7')

prepare()
{
# FIXME: Achtung!
# fix scintilla2 download path
  sed -i "s;\"http://www.riverbankcomputing.co.uk\$_download_path\";\
\`echo \$_download_path | sed \"s#http://#http://optimate.dl.#\"\
| sed \"s#projects/pyqt/files#project/pyqt#\"\`;" ${srcdir}/${pkgname}/get_qsci.sh
# fix filepath
  sed -i "s:QScintilla2/Qt4:QScintilla2/Qt4Qt5:" ${srcdir}/${pkgname}/qscite.pro
# fix version
  sed -i "s:0.5-svn190:${pkgver}:" ${srcdir}/${pkgname}/qscite.desktop
}

build() 
{
  cd ${srcdir}/${pkgname}
  qmake-qt4 qscite-release.pro || return 1
  make || return 1
}

package()
{
# makefile haven't install section
  install -D -m755 ${srcdir}/${pkgname}/build/${pkgname}-release ${pkgdir}/usr/bin/${pkgname}
  install -D -m644 ${srcdir}/${pkgname}/${pkgname}.desktop ${pkgdir}/usr/share/applications/${pkgname}.desktop
}
